---
title: "W9：估計理論——捕捉真理的網"
subtitle: "基礎統計學 2026"
author: "慈濟大學"
date: "`r Sys.Date()`"
output:
  revealjs::revealjs_presentation:
    theme: simple
    highlight: pygments
    center: false
    transition: slide
    self_contained: true
    css: custom.css
    reveal_options:
      slideNumber: true
      previewLinks: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,
                      fig.width = 9, fig.height = 5)
library(ggplot2)
library(tidyr)
library(dplyr)

# 示範用母群（與 W8 相同，seed_digits=0）
set.seed(4000)
q1 <- sample(1:5, 10000, replace = TRUE, prob = c(0.05, 0.15, 0.30, 0.35, 0.15))
q2 <- sample(1:5, 10000, replace = TRUE, prob = c(0.10, 0.15, 0.30, 0.30, 0.15))
q3 <- sample(1:5, 10000, replace = TRUE, prob = c(0.15, 0.35, 0.30, 0.15, 0.05))
q4 <- sample(1:5, 10000, replace = TRUE, prob = c(0.05, 0.15, 0.35, 0.30, 0.15))
q5 <- sample(1:5, 10000, replace = TRUE, prob = c(0.10, 0.10, 0.30, 0.30, 0.20))
demo_total <- q1 + q2 + (6L - q3) + q4 + q5

pop_mean <- mean(demo_total)
pop_sd   <- sd(demo_total)
```

# 本週學習目標

**理解概念**：

1. 區分「點估計」與「區間估計」
2. 正確解讀 **95% 信賴區間 (CI)** 的意義
3. 理解**自由度 (df)** 與 **t 分佈**的由來

---

**數學工具**：

1. 信賴區間公式：$CI = \bar{X} \pm t_{(df, \alpha/2)} \times SE$
2. 自由度：$df = N - 1$

**軟體操作**：

1. 在 jamovi 中使用 Descriptives 的 CI for Mean

---

## 對應教材

- 《用 jamovi 上手統計學》
  - [第 8 章：運用樣本估計未知量數](https://scgeeker.github.io/lsj-book-zh_tw/08-Estimating-unknown-quantities-from-a-sample.html#sec-Estimating-point-of-parameters)（8.4-8.6）

**簡報示範資料**：課堂 R 動態圖

**作業資料**：個人化 `W09_CI_Samples_[學號].csv`


# Part 1：點估計——通常是錯的

---

## 回顧 W8：你已經知道的事

W8 你學到了：

- 每次從母群抽樣，得到的 $\bar{X}$ 都不太一樣
- $\bar{X}$ 的抽樣分佈以 $\mu$ 為中心，寬度 = $SE$
- $N$ 越大 → $SE$ 越小 → $\bar{X}$ 越接近 $\mu$

**問題**：既然 $\bar{X}$ 每次都不一樣，我們怎麼知道真正的 $\mu$ 是多少？

---

## 點估計：最佳猜測

**點估計（Point Estimate）**：用單一數值猜測母群參數

- $\hat{\mu} = \bar{X}$（樣本平均數估計母群平均數）
- $\hat{\sigma} = s$（樣本標準差估計母群標準差）

---

## 點估計的問題

```{r point-estimates, fig.height=4.5, fig.height=3}
set.seed(909)
n_samples <- 20
sample_means <- replicate(n_samples, mean(sample(demo_total, 30)))

df_points <- data.frame(
  樣本 = factor(1:n_samples),
  平均數 = sample_means
)

ggplot(df_points, aes(x = 樣本, y = 平均數)) +
  geom_point(size = 3, color = "#3498db") +
  geom_hline(yintercept = pop_mean, linetype = "dashed",
             color = "#e74c3c", size = 1) +
  annotate("text", x = 18, y = pop_mean + 0.15,
           label = paste0("母群真值 μ = ", round(pop_mean, 2)),
           color = "#e74c3c", size = 5, fontface = "bold") +
  labs(title = "20 次獨立抽樣（N=30），每次的平均數都不同",
       x = "第幾次抽樣", y = "樣本平均數") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))
```

> 每個點都是一次「最佳猜測」，但幾乎沒有一個剛好命中紅線！

---

## 魚槍 vs. 漁網

:::::::::::::: {.columns}
::: {.column width="50%"}

**點估計 = 魚槍**

- 瞄準一個點射出去
- 命中目標的機率**極低**
- $\bar{X} = 17.3$ → 真的是 17.3 嗎？

:::
::: {.column width="50%"}

**區間估計 = 漁網**

- 張開一定範圍的網
- **捕獲目標的機率很高**
- $\bar{X} \in [16.5, 18.1]$ → 更有用！

:::
::::::::::::::

> 統計學的智慧：承認不確定性，用**範圍**取代**精確值**


# Part 2：信賴區間——撒網的藝術

---

## 信賴區間（CI）的直覺

**95% 信賴區間**的意思是：

如果我用同樣的方法**反覆抽樣 100 次**，每次都計算一個區間...

→ 大約有 **95 個區間**會包含真正的 $\mu$

→ 大約有 **5 個區間**會落空

---

## 100 個信賴區間的模擬

```{r ci-simulation, fig.height=5.5}
set.seed(2026)
n_ci <- 100
sample_size <- 30

ci_data <- data.frame(
  id = 1:n_ci,
  mean = numeric(n_ci),
  lower = numeric(n_ci),
  upper = numeric(n_ci),
  contains_mu = logical(n_ci)
)

for (i in 1:n_ci) {
  s <- sample(demo_total, sample_size)
  m <- mean(s)
  se <- sd(s) / sqrt(sample_size)
  t_crit <- qt(0.975, df = sample_size - 1)
  ci_data$mean[i] <- m
  ci_data$lower[i] <- m - t_crit * se
  ci_data$upper[i] <- m + t_crit * se
  ci_data$contains_mu[i] <- (ci_data$lower[i] <= pop_mean) & (pop_mean <= ci_data$upper[i])
}

n_hit <- sum(ci_data$contains_mu)

ggplot(ci_data, aes(x = id, y = mean, color = contains_mu)) +
  geom_point(size = 1.2) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.3, size = 0.4) +
  geom_hline(yintercept = pop_mean, linetype = "dashed",
             color = "#e74c3c", size = 0.8) +
  scale_color_manual(values = c("TRUE" = "#3498db", "FALSE" = "#e74c3c"),
                     labels = c("TRUE" = "包含 μ", "FALSE" = "未包含 μ"),
                     name = "") +
  annotate("text", x = 85, y = pop_mean + 0.6,
           label = paste0("μ = ", round(pop_mean, 2)),
           color = "#e74c3c", size = 4.5, fontface = "bold") +
  labs(title = sprintf("100 個 95%% CI（N=30）：%d 個包含 μ，%d 個落空",
                        n_hit, n_ci - n_hit),
       x = "第幾次抽樣", y = "Total_Score") +
  theme_minimal(base_size = 13) +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"),
        legend.position = "top")
```

---

## CI 的公式

$$CI = \bar{X} \pm t_{(df,\; \alpha/2)} \times SE$$

拆開來看：

- $\bar{X}$：樣本平均數（網子的**中心**）
- $SE = \frac{s}{\sqrt{N}}$：標準誤（網子的**基本寬度**）
- $t_{(df,\; \alpha/2)}$：t 臨界值（把網子**撐開的乘數**）
- $df = N - 1$：自由度（決定乘數大小）

---

## CI 的寬度由什麼決定？

$$\text{CI 寬度} = 2 \times t_{(df,\; \alpha/2)} \times SE = 2 \times t_{(df,\; \alpha/2)} \times \frac{s}{\sqrt{N}}$$

**兩個關鍵因素**：

1. **$N$ 越大** → $SE$ 越小 + $t$ 越接近常態 → 網子越窄
2. **信心水準越高**（99% vs 95%） → $t$ 越大 → 網子越寬

> 精確度與信心的取捨：想要更有信心？就得接受更寬的網子。

---

## 互動體驗：Seeing Theory

試試看這個互動模擬：

[Seeing Theory — 信賴區間](https://seeing-theory.brown.edu/frequentist-inference/index.html#section2)

**操作建議**：

1. 選擇 **Normal** 分佈
2. 設定 $n = 5$，按「抽樣」多次 → 觀察 CI 寬度
3. 改成 $n = 100$，再抽 → 比較 CI 有多窄
4. 改信心水準為 **0.99** → 觀察網子變多寬


# Part 3：自由度——估計的代價

---

## 為什麼不是除以 $N$？

回想 W8 的 $SE$ 公式：

$$SE = \frac{s}{\sqrt{N}} \quad \text{其中} \quad s = \sqrt{\frac{\sum(X_i - \bar{X})^2}{N - 1}}$$

**問題**：$s$ 的分母為什麼是 $N - 1$ 而不是 $N$？

---

### 聚餐 AA 制的譬喻

<small>
5 個人聚餐，帳單總計 $1000 元（已知）

- 第 1 個人出 $250 → 自由選擇 ✓

- 第 2 個人出 $150 → 自由選擇 ✓

- 第 3 個人出 $200 → 自由選擇 ✓

- 第 4 個人出 $300 → 自由選擇 ✓

- 第 5 個人出 $100 → **沒得選！** ✗（被前 4 人決定了）

**自由度 = 5 - 1 = 4**
</small>

> 當你用 $\bar{X}$ 來計算 $s$ 時，$\bar{X}$ 就像「已知的總帳單」——最後一個離均差被前面的決定了。

---

## 為什麼要計算 $s$

- 許多研究狀況無法得知 $\sigma$

- 計算CI需要估計標準誤（SE）

- **代價**：$s$ 本身也有誤差 → CI估計不確定性增加 → 網子要張更開

---

## t 分佈：小樣本的「懲罰」

**功能**：*自由度*是決定t分佈形狀的唯一**參數**

```{r t-distribution, fig.height=4}
x_vals <- seq(-4, 4, length.out = 300)

df_t <- rbind(
  data.frame(x = x_vals, 密度 = dnorm(x_vals),
             分佈 = "常態分佈"),
  data.frame(x = x_vals, 密度 = dt(x_vals, df = 29),
             分佈 = "t 分佈（df = 29）"),
  data.frame(x = x_vals, 密度 = dt(x_vals, df = 4),
             分佈 = "t 分佈（df = 4）")
)

df_t$分佈 <- factor(df_t$分佈,
  levels = c("常態分佈",
             "t 分佈（df = 29）",
             "t 分佈（df = 4）"))

ggplot(df_t, aes(x = x, y = 密度, color = 分佈, linetype = 分佈)) +
  geom_line(size = 1.2) +
  scale_color_manual(values = c("#2ecc71", "#3498db", "#e74c3c")) +
  scale_linetype_manual(values = c("solid", "dashed", "dotted")) +
  labs(title = "t 分佈 vs 常態分佈：df 越小，尾巴越厚",
       x = "", y = "機率密度") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"),
        legend.position = "top",
        legend.title = element_blank())
```

---

## t 分佈的關鍵特性

- df 越小 → 尾巴越厚 → $t$ 臨界值越大 → CI 越寬
- df 越大 → 越接近常態分佈 → $t$ 越接近 1.96

```{r t-critical-values}
df_vals <- c(4, 9, 29, 99, Inf)
n_vals  <- c(5, 10, 30, 100, "∞")
t_crits <- c(qt(0.975, df = 4), qt(0.975, df = 9),
             qt(0.975, df = 29), qt(0.975, df = 99), qnorm(0.975))
```

| $N$ | $df = N-1$ | $t_{0.025}$ | 相對於 1.96 |
|:--:|:--:|:--:|:--:|
| 5 | 4 | `r round(t_crits[1], 3)` | +`r round((t_crits[1]/1.96 - 1)*100, 0)`% |
| 10 | 9 | `r round(t_crits[2], 3)` | +`r round((t_crits[2]/1.96 - 1)*100, 0)`% |
| 30 | 29 | `r round(t_crits[3], 3)` | +`r round((t_crits[3]/1.96 - 1)*100, 0)`% |
| 100 | 99 | `r round(t_crits[4], 3)` | +`r round((t_crits[4]/1.96 - 1)*100, 0)`% |
| ∞ | ∞ | 1.960 | 0% |

> $N = 5$ 時，乘數比常態多了約 **40%** → CI 寬了 40%！

---

## N 對 CI 寬度的影響（模擬）

```{r ci-width-comparison, fig.height=4.5}
set.seed(919)

# 從同一母群抽取三組
idx_100 <- sample(length(demo_total), 100)
idx_30  <- idx_100[1:30]
idx_5   <- idx_100[1:5]

calc_ci <- function(x) {
  m <- mean(x)
  se <- sd(x) / sqrt(length(x))
  t_crit <- qt(0.975, df = length(x) - 1)
  c(mean = m, lower = m - t_crit * se, upper = m + t_crit * se,
    se = se, width = 2 * t_crit * se)
}

ci_5   <- calc_ci(demo_total[idx_5])
ci_30  <- calc_ci(demo_total[idx_30])
ci_100 <- calc_ci(demo_total[idx_100])

df_ci <- data.frame(
  樣本 = factor(c("N = 5", "N = 30", "N = 100"),
                levels = c("N = 5", "N = 30", "N = 100")),
  平均數 = c(ci_5["mean"], ci_30["mean"], ci_100["mean"]),
  下界 = c(ci_5["lower"], ci_30["lower"], ci_100["lower"]),
  上界 = c(ci_5["upper"], ci_30["upper"], ci_100["upper"]),
  寬度 = c(ci_5["width"], ci_30["width"], ci_100["width"])
)

ggplot(df_ci, aes(x = 樣本, y = 平均數)) +
  geom_point(size = 4, color = "#3498db") +
  geom_errorbar(aes(ymin = 下界, ymax = 上界),
                width = 0.2, size = 1.2, color = "#3498db") +
  geom_hline(yintercept = pop_mean, linetype = "dashed",
             color = "#e74c3c", size = 0.8) +
  geom_text(aes(label = sprintf("CI 寬度 = %.1f", 寬度)),
            vjust = -1.5, size = 4.5, fontface = "bold") +
  annotate("text", x = 3.3, y = pop_mean,
           label = paste0("μ = ", round(pop_mean, 2)),
           color = "#e74c3c", size = 4, fontface = "bold") +
  labs(title = "樣本數對 95% CI 寬度的影響",
       y = "Total_Score") +
  coord_cartesian(ylim = c(pop_mean - 4, pop_mean + 4)) +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))
```


# Part 4：正確解讀 CI

---

## 最常見的錯誤

> ❌「母群平均數有 95% 的機率落在這個區間內」

**為什麼錯？**

- $\mu$ 是一個**固定的數字**（只是我們不知道）
- $\mu$ 不會「跑來跑去」，所以不能說它「有幾 % 的機率在某處」
- 「機率」描述的是**方法**，不是**結果**

---

## 正確的解讀

> ✓「我們有 95% 的信心，這個區間涵蓋了母群平均數」

**更精確地說**：

如果我們用**相同的方法**反覆抽樣、反覆計算 CI

→ **長期而言**，95% 的區間會包含 $\mu$

→ 眼前這**一個**區間，要嘛包含、要嘛不包含——但我們**信任這個方法**

---

## 釣魚的譬喻

- 95% CI ≠ 「魚有 95% 的機率在網子裡」
- 95% CI = 「這種撒網技術，**長期命中率**是 95%」

你無法確定**這一網**有沒有撈到

但你信任**這個技術**——因為它的長期表現很好

---

## 用 jamovi 計算 CI

**操作步驟**：

1. **Exploration → Descriptives**
2. 將變項拖入分析
3. 勾選 **Statistics → Confidence interval for Mean**

---

## 用 jamovi 計算 CI（續）

**解讀輸出**：

- **Mean**：點估計值 $\bar{X}$
- **95% CI Lower Bound**：區間下界
- **95% CI Upper Bound**：區間上界
- **S.E. Mean**：$SE = s / \sqrt{N}$

> CI 的寬度 ≈ $2 \times t \times SE$（你可以驗算看看！）


# Part 5：作業說明

---

## 本週作業：三種樣本的 CI 比較

**資料**：個人化 `W09_CI_Samples_[學號].csv`

你的資料包含 3 個變項：

| 變項 | 說明 |
|:-----|:-----|
| `Sample_N5` | Total_Score 樣本（N=5） |
| `Sample_N30` | Total_Score 樣本（N=30） |
| `Sample_N100` | Total_Score 樣本（N=100） |

三組都來自你的個人母群（與 W4-W8 相同）

---

## 任務 1：計算三組的 95% CI

**操作**：

1. 匯入 CSV，設定三個變項為 **Continuous**
2. 使用 **Exploration → Descriptives**
3. 勾選 **Statistics**：Mean, SD, S.E. Mean, **CI for Mean (95%)**

---

**記錄**：整理三組的描述統計與 CI

| | N=5 | N=30 | N=100 |
|:--|:--:|:--:|:--:|
| Mean | | | |
| SD | | | |
| SE | | | |
| 95% CI 下界 | | | |
| 95% CI 上界 | | | |
| CI 寬度 | | | |

---

## 任務 2：CI 寬度的視覺化比較

**操作**：在報告中說明

- 三組 CI 的寬度分別是多少？
- 為什麼 N=5 的 CI 最寬？請從 **SE** 和 **t 臨界值**兩個角度解釋

**提示**：

- $SE = SD / \sqrt{N}$，N 越大 → SE 越小
- $t_{(df=4)} = `r round(qt(0.975, 4), 3)`$ vs $t_{(df=29)} = `r round(qt(0.975, 29), 3)`$ vs $t_{(df=99)} = `r round(qt(0.975, 99), 3)`$

---

## 任務 3：觀念辨析

在報告中回答以下問題：

1. **CI 解讀**：某位同學計算出 N=30 的 95% CI 為 [15.2, 18.8]，他說「母群平均數有 95% 的機率落在 15.2 到 18.8 之間」。這句話正確嗎？請說明理由並修正。

2. **自由度**：為什麼計算樣本標準差時要除以 $N-1$ 而不是 $N$？請用自己的話解釋。

3. **N 的代價**：如果你是研究者，想將 CI 寬度縮小一半，你需要將樣本數增加多少倍？（提示：想想 $SE = SD / \sqrt{N}$ 的數學關係）

---

## 繳交要求

**檔案 1：學號_姓名_W9_Lab.omv**

- 3 個變項的 Descriptives 分析
- 確認已勾選：Mean, SD, S.E. Mean, CI for Mean

**檔案 2：學號_姓名_W9_Report.docx**

- 描述統計整理表（三組 CI 比較）
- CI 寬度分析（任務 2）
- 反思問題：回答 3 題觀念問題

**繳交期限**：本週上課結束前


# 小結與展望

---

## 本週核心概念

1. **點估計 vs 區間估計**：用範圍取代精確值，承認不確定性
2. **95% CI**：長期而言 95% 的區間包含 $\mu$（方法的可靠度）
3. **自由度**：估計 $\sigma$ 的代價，df = N - 1
4. **t 分佈**：df 越小 → 尾巴越厚 → CI 越寬
5. **N 的槓桿**：N 越大 → SE 越小 + t 越小 → CI 越窄

---

## 下週預告：假設檢定與單一樣本 t 檢定

**下週問題**：

- 「平均數跟常模不一樣」到底算不算有差異？
- 什麼是 $p$ 值？怎麼用它做決策？
- 「統計顯著」等於「實務重要」嗎？

**核心譬喻**：法庭審判——無罪推定 ($H_0$) vs. 證據力 ($p$)

**資料**：W10 模擬實驗資料（大小樣本的顯著性比較）

---

## 課後資源

**電子書**：

- [第 8 章：8.4-8.6 區間估計](https://scgeeker.github.io/lsj-book-zh_tw/08-Estimating-unknown-quantities-from-a-sample.html)

**互動模擬**：

- [Seeing Theory — 信賴區間](https://seeing-theory.brown.edu/frequentist-inference/index.html#section2)

---

**關鍵術語對照**：

| 中文 | 英文 | 符號 |
|:-----|:-----|:-----|
| 點估計 | Point Estimate | $\hat{\mu}$ |
| 區間估計 | Interval Estimate | CI |
| 信賴區間 | Confidence Interval | 95% CI |
| 信心水準 | Confidence Level | $1 - \alpha$ |
| 自由度 | Degrees of Freedom | $df$ |
| t 分佈 | Student's t Distribution | $t_{(df)}$ |

---

## Q & A
