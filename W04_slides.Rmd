---
title: "W4：資料清理——處理現實的雜亂"
subtitle: "心理教育統計 2026"
author: "授課教師：陳紹慶 | e-mail: csc2009@mail.tcu.edu.tw"
date: "2026/03/16"
output:
  revealjs::revealjs_presentation:
    theme: simple
    highlight: pygments
    center: false
    transition: slide
    self_contained: true
    css: custom.css
    reveal_options:
      slideNumber: true
      previewLinks: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

# 本週學習目標

## 學習成效指標

**認知規範**：

1. 理解非破壞性編輯的重要性
2. 掌握邏輯運算語法

**操作技能**：

1. 熟練使用 Filters 篩選資料
2. 執行重新編碼 (Recoding)
3. 計算總分與反向計分

---

## 對應教材

- 《用 jamovi 上手統計學》
  - [第 6 章：實務課題](https://scgeeker.github.io/lsj-book-zh_tw/manipulating-data.html)

**簡報示範資料**：電子書範例 / 通用示範檔
**作業資料**：個人化生成（依學號）

# Part 1：資料衛生意識

## Garbage In, Garbage Out

> **資料品質決定分析品質**

再精密的統計方法，也無法從垃圾資料中提煉出真相

---

## 現實世界的資料問題

| 問題類型 | 例子 |
|----------|------|
| 輸入錯誤 | 年齡 = 200 歲 |
| 編碼不一致 | Gender: M, 1, Male, male |
| 極端值 | 反應時間 = 9999 ms |
| 遺漏值 | 空白儲存格、NA |

---

## 為什麼不能直接刪除？

**錯誤做法**：在 Excel 中刪除「不想要」的列

**問題**：

1. 無法追蹤刪除了什麼
2. 無法還原操作
3. 無法重現分析過程

---

## 非破壞性編輯原則

> **永遠保留原始資料 (Raw Data)**

- 使用 **Filter** 排除異常值
- 使用 **Compute** 建立新變項
- 使用 **Recode** 統一編碼

# Part 2：Filter 篩選器

## Filter 的概念

> **Filter = 告訴軟體「只看」符合條件的資料**

- 不會刪除原始資料
- 可以隨時關閉
- 分析結果只計算通過篩選的樣本

---

## 邏輯運算子

| 運算子 | 意義 | 範例 |
|--------|------|------|
| `==` | 等於 | `Gender == 1` |
| `!=` | 不等於 | `Gender != 99` |
| `>` | 大於 | `Age > 18` |
| `<` | 小於 | `Age < 100` |
| `>=` | 大於等於 | `Score >= 60` |
| `<=` | 小於等於 | `Age <= 65` |

---

## 複合條件

| 運算子 | 意義 | 範例 |
|--------|------|------|
| `and` | 且 | `Age > 18 and Age < 65` |
| `or` | 或 | `Gender == 1 or Gender == 2` |
| `not` | 非 | `not (Age > 100)` |

---

## jamovi 操作：建立 Filter

1. 點擊「Data」分頁
2. 點擊「Filters」
3. 輸入條件：`Age <= 100`
4. 按 Enter 確認

**結果**：不符合條件的列會變灰色

---

## 實作練習：排除異常年齡

**情境**：資料中有人填了 200 歲、250 歲

**Filter 條件**：

```
Age <= 100
```

**檢查**：觀察被排除的筆數

# Part 3：Compute 計算變項

## 為什麼需要計算變項？

**情境**：5 題量表，需要加總得到總分

**問題**：其中 Q3 是反向題

**解決**：

1. 先建立 `Q3_r`（反向計分後）
2. 再計算 `Total = Q1 + Q2 + Q3_r + Q4 + Q5`

---

## 反向計分的原理

**原始量表**：1 = 非常不同意 → 5 = 非常同意

**反向題**：分數意義相反

**轉換公式**：`新分數 = (最大值 + 1) - 原分數`

| 原始 | 反向後 |
|------|--------|
| 1 | 5 |
| 2 | 4 |
| 3 | 3 |
| 4 | 2 |
| 5 | 1 |

---

## jamovi 操作：建立計算變項

1. 切換「Data Tab」
2. 選擇資料表最右側變項的下一欄位
3. 選擇「Computed Variable」
4. 命名為 `Q3_r`
5. 輸入公式：`6 - Q3`
6. 重覆以上步驟，再建立計算變項`Total_Score`

---

## 計算總分

**公式**：

```
Q1 + Q2 + Q3_r + Q4 + Q5
```

**注意**：

- 使用 `Q3_r`，不是 `Q3`
- 若使用原始 Q3，總分計算會錯誤

# Part 4：Recode 重新編碼

## 編碼不一致的問題

**資料中的 Gender**：

- 數字：1, 2
- 英文：M, F, Male, Female, male

**問題**：jamovi 會當成不同類別

---

## 解決方案：Transform變項

1. 建立Transform變項 `Gender_clean`
2. 使用 Recode 功能統一編碼

**目標**：

- 1, M, Male → male（男）
- 2, F, Female → female（女）

---

## jamovi 操作：Transform

1. 切換「Data Tab」
2. 點選要轉換的Variable→按「Transform」
3. 設定對應規則：
   - `M`, `Male`, `male`, `1` → `1`
   - `F`, `Female`, `2` → `2`
4. 套用至 `Gender` 欄位

# Part 5：處理遺漏值

## 遺漏值 (Missing Values)

**常見形式**：

- 空白儲存格
- NA、N/A
- 特殊編碼：-99、999

---

## jamovi 的處理方式

- 自動識別空白為遺漏值
- 分析時自動排除
- 可在**系統設定**中定義遺漏值代碼

---

## 遺漏值的影響

**例**：計算 5 人的平均數

| 有遺漏 | 無遺漏 |
|--------|--------|
| 10, 20, NA, 40, 50 | 10, 20, 30, 40, 50 |
| 平均 = 30 (n=4) | 平均 = 30 (n=5) |

**jamovi 預設**：listwise deletion（*整列排除*）

# Part 6：APA 寫作——方法段雛形

## 學術寫作第二步

> 上週 (W3) 學會了用完整句子描述變項
>
> 這週進階：**記錄你的資料處理過程**

在學術論文的「方法（Method）」章節中，你需要清楚記錄資料處理的每一個步驟。

---

## 為什麼要記錄資料處理？

**三個理由**：

1. **可重製 (Reproducibility)**：其他研究者能重行驗證你的分析
2. **透明度 (Transparency)**：審查者能檢驗你的決策
3. **記錄你的思考**：未來的你（或同事）能理解當初為什麼這樣做

---

## 方法段的標準格式

**應包含的資訊**：

1. **原始樣本數** (*N*) 與 **有效樣本數** (*N*)
2. **排除準則**（例如：年齡不合理、缺漏值）
3. **資料轉換**：
   - 變項重新編碼（例如：Gender 1/2 → Male/Female）
   - 反向計分（哪些題目？用什麼公式？）
   - 總分計算（用哪些題目？）

---

## 範例：資料處理描述

> 「原始資料包含 *N* = 150 筆觀察值。為確保資料品質，移除年齡大於 100 歲的不合理數值，篩選後有效樣本為 *N* = 142。性別變項 (Gender) 的數值編碼統一採用 Male代表男性，Female代表女性。量表第三題 採用反向計分，其餘題目維持原始分數。最後計算五個量表題目的總分(Total_Score)，總分範圍為 5 至 25 分。」

---

## 注意格式細節

**樣本數符號**：使用斜體 *N*

- ✅ 正確：有效樣本為 ***N* = 142**
- ❌ 錯誤：有效樣本為 **N = 142**（沒有斜體）

**使用完整句子與連貫段落**：

- ✅ 正確：「原始資料包含 *N* = 150 筆觀察值。為確保資料品質...」
- ❌ 錯誤（簡報式報告）：
  - 原始樣本：150
  - 排除異常值
  - 有效樣本：142

---

## W4 報告新增目標

**【APA 寫作練習：方法段（資料處理）】**

請用一段完整的文字描述：

1. 原始樣本數與有效樣本數（使用 *N* 符號）
2. 排除準則（例如：Age > 100）
3. Gender 重新編碼
4. Q3 反向計分（公式：6 - Q3）
5. Total_Score 計算（Q1 + Q2 + Q3_r + Q4 + Q5）


---

## APA 累積進度

| 週次 | APA 元素 | 進度 |
|------|----------|------|
| **W3** | 變項描述（完整句） | ✅ 已學會 |
| **W4** | 方法段（資料處理）+ *N* 符號 | ⬅️ 本週 |
| W5 | 統計符號格式 (*M*, *SD*, *Mdn*) | 下週 |
| W6 | 圖表格式 (Figure/Table) | 即將學習 |
| W7 | 結果段整合練習 | 即將學習 |

---

# 本週作業（1 小時實作）

## W4 作業：資料清理挑戰

**資料檔**：個人化資料（依學號生成）

**jamovi 操作任務**：

1. 建立 Filter：排除 `Age <= 100`
2. 統一 Gender 編碼：建立 `Gender_clean`（1 → Male, 2 → Female）
3. 建立 `Q3_r`（反向計分公式：`6 - Q3`）
4. 計算 `Total_Score`（公式：`Q1 + Q2 + Q3_r + Q4 + Q5`）

---

## 繳交項目與時程

1. `學號_姓名_W4_Lab.omv`（jamovi 檔案）
2. `學號_姓名_W4_Report.docx`（Word 報告）

**報告模板**：請從 Google Classroom 下載 `W4_Report_Template.docx`

**報告內容**：

- 【APA 寫作練習】：方法段（資料處理）描述
- 【操作紀錄】：技術細節記錄
- 【反思問題】：四題必答

**繳交時間**：本堂課下課前上傳至 Google Classroom

**評量回饋**：2 天內收到個人評量報告

**修正機會**：下次上課前可回報改進版本

---

## 評分標準（配分調整）

| 項目 | 配分 | 說明 |
|------|------|------|
| 檔名格式 | 15% | 命名規範 |
| Filter 設定 | 15% | Age <= 100 |
| Gender 重編碼 | 15% | Gender_clean |
| Q3 反向計分 | 15% | Q3_r = 6 - Q3 |
| Total_Score 計算 | 10% | 五題加總 |
| **Word 報告與寫作** | **30%** | APA 方法段落 + 4 題反思 |

---

## 反思問題（報告必答）

**Q1**：為什麼使用 **Computed Variable** 建立新變項（如 Q3_r），而不是直接修改原始的 Q3 數值？這種「非破壞性編輯」有什麼好處？

---

**Q2**：jamovi 的 **Filter** 功能與直接 **刪除列 (Delete Rows)** 有什麼不同？在學術研究中，為什麼我們偏好使用 Filter？

---

**Q3**：假設你要將這份作業的資料清理流程分享給同學，讓他能夠用不同的資料重現你的步驟。你在「方法段（資料處理）」中需要記錄哪些關鍵資訊？

---

**Q4**：在問卷設計中，為什麼會有些題目需要反向計分？請舉一個例子說明（可以參考 WellBeing 量表或其他你知道的量表）。

# 重點回顧

## 本週關鍵概念

1. **非破壞性編輯**：不直接修改原始資料
2. **Filter**：篩選而非刪除
3. **Compute**：計算新變項
4. **Recode**：統一編碼
5. **反向計分**：`(max + 1) - score`

---

## 下週預告

**W5：描述統計**

- 集中趨勢：平均數、中位數、眾數
- 離散程度：標準差、四分位距
- 使用清理後的資料進行分析

---

## Q&A

有任何問題嗎？

---

<div style="text-align: center; margin-top: 2em;">
**心理教育統計 2026**

慈濟大學
</div>
