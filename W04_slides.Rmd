---
title: "W4：資料清理——處理現實的雜亂"
subtitle: "基礎統計學 2026"
author: "慈濟大學"
date: "`r Sys.Date()`"
output:
  revealjs::revealjs_presentation:
    theme: simple
    highlight: pygments
    center: false
    transition: slide
    self_contained: true
    css: custom.css
    reveal_options:
      slideNumber: true
      previewLinks: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

# 本週學習目標

## 學習成效指標

**認知規範**：

1. 理解非破壞性編輯的重要性
2. 掌握邏輯運算語法

**操作技能**：

1. 熟練使用 Filters 篩選資料
2. 執行重新編碼 (Recoding)
3. 計算總分與反向計分

---

## 對應教材

- 《用 jamovi 上手統計學》
  - [第 6 章：實務課題](https://scgeeker.github.io/lsj-book-zh_tw/manipulating-data.html)

**簡報示範資料**：電子書範例 / 通用示範檔
**作業資料**：個人化生成（依學號）

# Part 1：資料衛生意識

## Garbage In, Garbage Out

> **資料品質決定分析品質**

再精密的統計方法，也無法從垃圾資料中提煉出真相

---

## 現實世界的資料問題

| 問題類型 | 例子 |
|----------|------|
| 輸入錯誤 | 年齡 = 200 歲 |
| 編碼不一致 | Gender: M, 1, Male, male |
| 極端值 | 反應時間 = 9999 ms |
| 遺漏值 | 空白儲存格、NA |

---

## 為什麼不能直接刪除？

**錯誤做法**：在 Excel 中刪除「不想要」的列

**問題**：

1. 無法追蹤刪除了什麼
2. 無法還原操作
3. 無法重現分析過程

---

## 非破壞性編輯原則

> **永遠保留原始資料 (Raw Data)**

- 使用 **Filter** 排除異常值
- 使用 **Compute** 建立新變項
- 使用 **Recode** 統一編碼

# Part 2：Filter 篩選器

## Filter 的概念

> **Filter = 告訴軟體「只看」符合條件的資料**

- 不會刪除原始資料
- 可以隨時關閉
- 分析結果只計算通過篩選的樣本

---

## 邏輯運算子

| 運算子 | 意義 | 範例 |
|--------|------|------|
| `==` | 等於 | `Gender == 1` |
| `!=` | 不等於 | `Gender != 99` |
| `>` | 大於 | `Age > 18` |
| `<` | 小於 | `Age < 100` |
| `>=` | 大於等於 | `Score >= 60` |
| `<=` | 小於等於 | `Age <= 65` |

---

## 複合條件

| 運算子 | 意義 | 範例 |
|--------|------|------|
| `and` | 且 | `Age > 18 and Age < 65` |
| `or` | 或 | `Gender == 1 or Gender == 2` |
| `not` | 非 | `not (Age > 100)` |

---

## jamovi 操作：建立 Filter

1. 點擊「Data」分頁
2. 點擊「Filters」
3. 輸入條件：`Age <= 100`
4. 按 Enter 確認

**結果**：不符合條件的列會變灰色

---

## 實作練習：排除異常年齡

**情境**：資料中有人填了 200 歲、250 歲

**Filter 條件**：

```
Age <= 100
```

**檢查**：觀察被排除的筆數

# Part 3：Compute 計算變項

## 為什麼需要計算變項？

**情境**：5 題量表，需要加總得到總分

**問題**：其中 Q3 是反向題

**解決**：

1. 先建立 `Q3_r`（反向計分後）
2. 再計算 `Total = Q1 + Q2 + Q3_r + Q4 + Q5`

---

## 反向計分的原理

**原始量表**：1 = 非常不同意 → 5 = 非常同意

**反向題**：分數意義相反

**轉換公式**：`新分數 = (最大值 + 1) - 原分數`

| 原始 | 反向後 |
|------|--------|
| 1 | 5 |
| 2 | 4 |
| 3 | 3 |
| 4 | 2 |
| 5 | 1 |

---

## jamovi 操作：建立計算變項

1. 點擊「Data」分頁
2. 點擊欄位標題右側的「+」
3. 選擇「Computed Variable」
4. 命名為 `Q3_r`
5. 輸入公式：`6 - Q3`

---

## 計算總分

**公式**：

```
Q1 + Q2 + Q3_r + Q4 + Q5
```

**注意**：

- 使用 `Q3_r`，不是 `Q3`
- 若使用原始 Q3，總分計算會錯誤

# Part 4：Recode 重新編碼

## 編碼不一致的問題

**資料中的 Gender**：

- 數字：1, 2
- 英文：M, F, Male, Female, male

**問題**：jamovi 會當成不同類別

---

## 解決方案：Transform

1. 建立新變項 `Gender_clean`
2. 使用 Recode 功能統一編碼

**目標**：

- 1, M, Male, male → 1（男）
- 2, F, Female → 2（女）

---

## jamovi 操作：Transform

1. 切換「Data Tab」
2. 點選要轉換的Variable→按「Transform」
3. 設定對應規則：
   - `M`, `Male`, `male`, `1` → `1`
   - `F`, `Female`, `2` → `2`
4. 套用至 `Gender` 欄位

# Part 5：處理遺漏值

## 遺漏值 (Missing Values)

**常見形式**：

- 空白儲存格
- NA、N/A
- 特殊編碼：-99、999

---

## jamovi 的處理方式

- 自動識別空白為遺漏值
- 分析時自動排除
- 可在變項設定中定義遺漏值代碼

---

## 遺漏值的影響

**例**：計算 5 人的平均數

| 有遺漏 | 無遺漏 |
|--------|--------|
| 10, 20, NA, 40, 50 | 10, 20, 30, 40, 50 |
| 平均 = 30 (n=4) | 平均 = 30 (n=5) |

**jamovi 預設**：listwise deletion（整列排除）

# 本週作業（1 小時實作）

## W4 作業：資料清理挑戰

**資料檔**：個人化資料（依學號生成）

**任務**：

1. 建立 Filter：排除 `Age > 100`, `RT_ms`無資料
2. 統一 Gender 編碼：使用轉換變項
3. 建立 `Q3_r`（反向計分）：使用轉換變項，取得Q3的真正計分
4. 計算 `Total_Score`：總計Q1~Q5分數

---

## 繳交項目與時程

1. `學號_姓名_W4_Lab.omv`
2. `學號_姓名_W4_Report.docx`

**報告內容**：

- 清理步驟紀錄
- 前後資料比較
- 反思問題回答

**繳交時間**：本堂課下課前上傳至 Google Classroom

**評量回饋**：2 天內收到個人評量報告

**修正機會**：下次上課前可回報改進版本

---

## 評分標準

| 項目 | 配分 |
|------|------|
| Filter 設定 | 20% |
| Gender 重編碼 | 15% |
| Q3 反向計分 | 20% |
| Total_Score 計算 | 15% |
| Word 報告 | 15% |
| 檔名格式 | 15% |

---

## 反思問題（報告必答）

**Q1**：為什麼使用 Filter 比直接刪除資料更好？

> 請說明「非破壞性編輯」的重要性

---

## 反思問題（續）

**Q2**：如果忘記對 Q3 做反向計分，直接加總會怎樣？

> 思考：Q3 分數高代表什麼？與其他題的方向一致嗎？

---

## 反思問題（續）

**Q3**：你的資料中有多少筆因 Filter 被排除？

> 這些被排除的資料應該如何處理？
> - 直接刪除？
> - 保留在原檔？
> - 在報告中說明？

# 重點回顧

## 本週關鍵概念

1. **非破壞性編輯**：不直接修改原始資料
2. **Filter**：篩選而非刪除
3. **Compute**：計算新變項
4. **Recode**：統一編碼
5. **反向計分**：`(max + 1) - score`

---

## 下週預告

**W5：描述統計**

- 集中趨勢：平均數、中位數、眾數
- 離散程度：標準差、四分位距
- 使用清理後的資料進行分析

---

## Q&A

有任何問題嗎？

---

<div style="text-align: center; margin-top: 2em;">
**基礎統計學 2026**

慈濟大學
</div>
