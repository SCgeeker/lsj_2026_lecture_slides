---
title: "W8：取樣理論與中央極限定理——化混亂為秩序"
subtitle: "心理教育統計 2026"
author: "授課教師：陳紹慶 | e-mail: csc2009@mail.tcu.edu.tw"
date: "2026/04/20"
output:
  revealjs::revealjs_presentation:
    theme: simple
    highlight: pygments
    center: false
    transition: slide
    self_contained: true
    css: custom.css
    reveal_options:
      slideNumber: true
      previewLinks: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,
                      fig.width = 9, fig.height = 5)
library(ggplot2)
library(tidyr)
library(dplyr)

# 示範用母群（使用測試學號的母群參數）
set.seed(4000)  # seed_digits=0 的母群 seed
q1 <- sample(1:5, 10000, replace = TRUE, prob = c(0.05, 0.15, 0.30, 0.35, 0.15))
q2 <- sample(1:5, 10000, replace = TRUE, prob = c(0.10, 0.15, 0.30, 0.30, 0.15))
q3 <- sample(1:5, 10000, replace = TRUE, prob = c(0.15, 0.35, 0.30, 0.15, 0.05))
q4 <- sample(1:5, 10000, replace = TRUE, prob = c(0.05, 0.15, 0.35, 0.30, 0.15))
q5 <- sample(1:5, 10000, replace = TRUE, prob = c(0.10, 0.10, 0.30, 0.30, 0.20))
demo_total <- q1 + q2 + (6L - q3) + q4 + q5
demo_rt    <- round(rgamma(10000, shape = 2, rate = 2/500))
```

# 本週學習目標

**理解概念**：

1. 區分「母群」與「樣本」、「參數」與「統計量」
2. 區分「樣本分佈」與「抽樣分佈」
3. 理解中央極限定理（CLT）的意義與威力

---

**數學工具**：

1. 標準誤（SE）的計算與意義：$SE = \frac{SD}{\sqrt{N}}$
2. 樣本數 N 對精確度的影響

**軟體操作**：

1. 在 jamovi 中解讀 S.E. Mean 的數值意義

---

## 對應教材

- 《用 jamovi 上手統計學》
  - [第 8 章：運用樣本估計未知量數](https://scgeeker.github.io/lsj-book-zh_tw/08-Estimating-unknown-quantities-from-a-sample.html)（8.1-8.3）

**簡報示範資料**：課堂 R 動態圖 + `IQsim.omv`

**作業資料**：個人化 CLT 模擬資料（`W08_CLT_Simulation_[學號].csv`）


# Part 1：上帝視角 vs. 人類視角

---

## 回顧：你的 W4 資料從哪裡來？

還記得 W4 的 100 筆資料嗎？

- 你清理了 Age 異常值、統一了 Gender 編碼
- 你反向計分 Q3，計算了 Total_Score
- W5/W6 你分析了 Total_Score 的描述統計和圖表
- W7 你檢驗了 Total_Score 是否符合常態分佈

**關鍵問題**：這 100 筆資料是「全部的真相」嗎？

---

## 喝湯的譬喻

**母群（Population）** = 整鍋湯

- 包含所有可能的觀測值
- 通常**不可能**全部測量
- 有「真實的」參數：$\mu$, $\sigma$

**樣本（Sample）** = 喝一口

- 從母群中選取的**部分**資料
- 我們實際能觀察到的
- 計算出的是「統計量」：$\bar{X}$, $s$

---

> **這一口鹹，整鍋湯就一定鹹嗎？**

不一定！這就是**抽樣誤差**。

每次喝一口，鹹度都不太一樣。

但如果你喝了**很多口**，平均起來就會**越來越接近整鍋湯的真實味道**。

---

## 揭密時刻：你的 100 筆資料來自 10,000 人母群

```{r population-reveal, fig.height=4}
# 展示母群 vs 樣本
set.seed(400)  # W4 抽樣 seed
sample_idx <- sample(10000, 100)
sample_ts <- demo_total[sample_idx]

df_compare <- rbind(
  data.frame(來源 = "母群（10,000人）", Total_Score = demo_total),
  data.frame(來源 = "你的樣本（100人）", Total_Score = c(sample_ts, rep(NA, 9900)))
)

ggplot(df_compare %>% filter(!is.na(Total_Score)),
       aes(x = Total_Score, fill = 來源)) +
  geom_histogram(binwidth = 1, alpha = 0.7, position = "identity") +
  facet_wrap(~來源, scales = "free_y") +
  scale_fill_manual(values = c("#3498db", "#e74c3c")) +
  labs(title = "母群 vs. 樣本的 Total_Score 分佈",
       x = "Total Score", y = "次數") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold"))
```

---

## 參數 vs. 統計量

| | 母群（Population） | 樣本（Sample） |
|:--|:--|:--|
| **符號** | 希臘字母 | 拉丁字母 |
| **平均數** | $\mu$（mu） | $\bar{X}$（X bar） |
| **標準差** | $\sigma$（sigma） | $s$ |
| **大小** | $N$（通常很大或無限） | $n$（我們收集到的） |
| **性質** | **固定但未知** | **已知但會變動** |

> 統計學的核心任務：用**已知的樣本統計量**推測**未知的母群參數**

---

## 取樣方法

**簡單隨機取樣**：母群中每個成員被選中的機率相等

- 就像從一袋球中隨機抽取
- 這是統計推論的理論基礎

---

## 取樣方法(續)

**現實中的問題**：

- 方便取樣（convenience sampling）：只調查身邊的人
- 自願者偏誤：只有有興趣的人回答
- 資格限制：只能取得特定群體資料

> **好的取樣** = 統計推論的生命線


# Part 2：大數法則——越多越準

---

## 大數法則（Law of Large Numbers）

**直覺理解**：

- 擲骰子 10 次，平均可能偏離 3.5 很多
- 擲骰子 10,000 次，平均幾乎就是 3.5

**數學表述**：

$$\text{當 } n \to \infty \text{ 時，} \bar{X} \to \mu$$

---

## 大數法則的視覺化

```{r law-of-large-numbers, fig.height=4.5}
set.seed(2026)
cumulative_means <- cumsum(demo_total[1:2000]) / (1:2000)
pop_mean <- mean(demo_total)

df_lln <- data.frame(
  樣本數 = 1:2000,
  累積平均 = cumulative_means
)

ggplot(df_lln, aes(x = 樣本數, y = 累積平均)) +
  geom_line(color = "#3498db", size = 0.8) +
  geom_hline(yintercept = pop_mean, linetype = "dashed",
             color = "#e74c3c", size = 1) +
  annotate("text", x = 1800, y = pop_mean + 0.15,
           label = paste0("母群平均 μ = ", round(pop_mean, 2)),
           color = "#e74c3c", size = 5, fontface = "bold") +
  labs(title = "大數法則：樣本越大，平均數越接近真值",
       x = "累積樣本數 (n)", y = "累積平均數") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))
```


# Part 3：中央極限定理——統計學的奇蹟

---

## 從一個實驗說起

想像你做了以下實驗：

1. 從母群隨機抽 **5 個人**，計算他們的平均數 → 記錄下來
2. 放回去，再抽 **5 個人**，計算平均數 → 再記錄
3. 重複 **1,000 次**

你會得到 **1,000 個平均數**。

**問題**：這 1,000 個平均數會排成什麼形狀？

---

## 先看 RT_ms：一個明顯偏態的變項

```{r rt-population, fig.height=4}
ggplot(data.frame(RT = demo_rt), aes(x = RT)) +
  geom_histogram(binwidth = 30, fill = "#e67e22", alpha = 0.8,
                 color = "white") +
  geom_vline(xintercept = mean(demo_rt), linetype = "dashed",
             color = "#c0392b", size = 1) +
  annotate("text", x = mean(demo_rt) + 100, y = Inf,
           label = paste0("μ = ", round(mean(demo_rt))),
           vjust = 2, color = "#c0392b", size = 5, fontface = "bold") +
  labs(title = "RT_ms 母群分佈（10,000 人）——明顯右偏",
       x = "反應時間（ms）", y = "次數") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))
```

**偏態係數**：`r round((sum((demo_rt - mean(demo_rt))^3) / length(demo_rt)) / sd(demo_rt)^3, 2)`（遠離 0 = 明顯偏態）

---

## CLT 奇蹟：偏態消失了！

```{r clt-demonstration, fig.height=5}
set.seed(808)
means_n5   <- replicate(1000, mean(sample(demo_rt, 5)))
means_n30  <- replicate(1000, mean(sample(demo_rt, 30)))
means_n100 <- replicate(1000, mean(sample(demo_rt, 100)))

df_clt <- rbind(
  data.frame(類型 = "母群 RT_ms\n（N=10,000）",
             值 = sample(demo_rt, 1000)),
  data.frame(類型 = "抽樣分佈\n（每次 N=5，共1000次）",
             值 = means_n5),
  data.frame(類型 = "抽樣分佈\n（每次 N=30，共1000次）",
             值 = means_n30),
  data.frame(類型 = "抽樣分佈\n（每次 N=100，共1000次）",
             值 = means_n100)
)

df_clt$類型 <- factor(df_clt$類型,
  levels = c("母群 RT_ms\n（N=10,000）",
             "抽樣分佈\n（每次 N=5，共1000次）",
             "抽樣分佈\n（每次 N=30，共1000次）",
             "抽樣分佈\n（每次 N=100，共1000次）"))

ggplot(df_clt, aes(x = 值)) +
  geom_histogram(aes(fill = 類型), bins = 40, alpha = 0.8, color = "white") +
  facet_wrap(~類型, scales = "free", nrow = 1) +
  scale_fill_manual(values = c("#e67e22", "#3498db", "#2ecc71", "#9b59b6")) +
  labs(title = "中央極限定理：即使母群偏態，平均數的分佈也會趨近常態",
       x = "數值", y = "次數") +
  theme_minimal(base_size = 12) +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold"),
        strip.text = element_text(face = "bold", size = 11))
```

---

## 中央極限定理（CLT）三大結論

無論母群的分佈形狀如何，當樣本數 $N$ 足夠大：

1. **抽樣分佈的平均數** = 母群平均數 $\mu$

2. **抽樣分佈的標準差** = $\frac{\sigma}{\sqrt{N}}$（就是**標準誤 SE**）

3. **抽樣分佈的形狀**趨近**常態分佈**

> **CLT 是統計推論的基石**：它告訴我們，不管母群長什麼樣子，只要 N 夠大，$\bar{X}$ 的行為就是可預測的。

---

## 樣本分佈 vs. 抽樣分佈

:::::::::::::: {.columns}
::: {.column width="50%"}

**樣本分佈**（Sample Distribution）

- **一組人的分數**怎麼分佈
- 例如：你的 100 筆 Total_Score
- 特徵：Mean, SD, 可能偏態

:::
::: {.column width="50%"}

**抽樣分佈**（Sampling Distribution）

- **很多組平均數**怎麼分佈
- 例如：1,000 次抽樣的 1,000 個 $\bar{X}$
- 特徵：趨近常態、寬度 = $SE = \frac{\sigma}{\sqrt{N}}$

:::
::::::::::::::

> 這是 W8 最重要的區分！混淆這兩者是學習統計最常見的障礙。


# Part 4：標準誤——精確度的量尺

---

## SD vs. SE：兩個容易混淆的概念

:::::::::::::: {.columns}
::: {.column width="50%"}

**標準差（SD）**

- 衡量**個別數據點**的分散程度
- 反映「個體差異」
- 公式：$SD = \sqrt{\frac{\sum(X_i - \bar{X})^2}{N-1}}$
- **不受樣本數影響**

:::
::: {.column width="50%"}

**標準誤（SE）**

- 衡量**平均數估計**的精確度
- 反映「取樣誤差」
- 公式：$SE = \frac{SD}{\sqrt{N}}$
- **N 越大，SE 越小**

:::
::::::::::::::

---

## SE 公式的直覺理解

$$SE = \frac{SD}{\sqrt{N}}$$

**為什麼除以 $\sqrt{N}$？**

- 當你平均 $N$ 個獨立觀測值，每個人的隨機誤差會「互相抵消」
- 平均的效果：把噪音降低 $\sqrt{N}$ 倍
- $N = 100$ 時，$\sqrt{100} = 10$ → 精確度提升 10 倍

---

## 精確度競賽：N=5 vs. N=100

```{r se-comparison, fig.height=4.5}
df_se <- rbind(
  data.frame(樣本數 = "N = 5\n（SD = SE）",
             平均數 = means_n5),
  data.frame(樣本數 = "N = 100\n（SD = SE）",
             平均數 = means_n100)
)

se_n5 <- round(sd(means_n5), 1)
se_n100 <- round(sd(means_n100), 1)

ggplot(df_se, aes(x = 平均數, fill = 樣本數)) +
  geom_histogram(bins = 40, alpha = 0.8, color = "white") +
  facet_wrap(~樣本數, scales = "free_y") +
  scale_fill_manual(values = c("#e74c3c", "#27ae60")) +
  labs(title = sprintf("抽樣分佈的寬度 = 標準誤（SE）：N=5 的 SE=%.1f vs N=100 的 SE=%.1f",
                       se_n5, se_n100),
       x = "樣本平均數", y = "次數") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
        strip.text = element_text(face = "bold", size = 12))
```

---

## SE 公式驗證

```{r se-verification}
pop_sd_rt <- sd(demo_rt)
theoretical_se_5   <- pop_sd_rt / sqrt(5)
theoretical_se_100 <- pop_sd_rt / sqrt(100)
actual_se_5   <- sd(means_n5)
actual_se_100 <- sd(means_n100)
```

| | 母群 SD | N | 理論 SE ($SD/\sqrt{N}$) | 實際 SE（模擬） |
|:--|:--:|:--:|:--:|:--:|
| N = 5 | `r round(pop_sd_rt, 1)` | 5 | `r round(theoretical_se_5, 1)` | `r round(actual_se_5, 1)` |
| N = 100 | `r round(pop_sd_rt, 1)` | 100 | `r round(theoretical_se_100, 1)` | `r round(actual_se_100, 1)` |

**比值驗證**：$\frac{SE_{N=100}}{SE_{N=5}} = \frac{\sqrt{5}}{\sqrt{100}} = `r round(sqrt(5)/sqrt(100), 3)`$

實際比值：`r round(actual_se_100 / actual_se_5, 3)`

> 理論完美吻合！$N$ 越大，平均數的估計越精準。

---

## Total_Score 也一樣

```{r total-score-clt, fig.height=4}
set.seed(809)
means_ts_n5   <- replicate(1000, mean(sample(demo_total, 5)))
means_ts_n100 <- replicate(1000, mean(sample(demo_total, 100)))

df_ts <- rbind(
  data.frame(類型 = "母群 Total_Score",
             值 = sample(demo_total, 1000)),
  data.frame(類型 = "抽樣分佈 N=5",
             值 = means_ts_n5),
  data.frame(類型 = "抽樣分佈 N=100",
             值 = means_ts_n100)
)

df_ts$類型 <- factor(df_ts$類型,
  levels = c("母群 Total_Score", "抽樣分佈 N=5", "抽樣分佈 N=100"))

ggplot(df_ts, aes(x = 值)) +
  geom_histogram(aes(fill = 類型), bins = 30, alpha = 0.8, color = "white") +
  facet_wrap(~類型, scales = "free", nrow = 1) +
  scale_fill_manual(values = c("#3498db", "#e74c3c", "#27ae60")) +
  labs(title = "Total_Score：母群已近似常態，N 越大 → 分佈越窄（SE 越小）",
       x = "數值", y = "次數") +
  theme_minimal(base_size = 12) +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold"),
        strip.text = element_text(face = "bold", size = 11))
```

> 即使母群已經近似常態，增大 $N$ 仍然能顯著縮小 SE！

---

## 用jamovi 計算 S.E. Mean

**操作步驟**：

1. Exploration → Descriptives
2. 勾選 **Statistics** → ✓ S.E. Mean

---

## 用jamovi 計算 S.E. Mean (續)

**解讀**：

- S.E. Mean = $\frac{SD}{\sqrt{N}}$
- 這個數字告訴你：「你的平均數估計有多精準」
- S.E. 越小 → 平均數估計越可靠

> **注意**：母群的**標準誤**是沒有意義的（母群已經是「真理」，不需要估計）

---

## 為什麼 N 是科學研究的最強槓桿？

| N | $\sqrt{N}$ | SE = SD / $\sqrt{N}$ | 精確度倍數 |
|:--:|:--:|:--:|:--:|
| 5 | 2.24 | SD × 0.45 | 1× |
| 30 | 5.48 | SD × 0.18 | 2.4× |
| 100 | 10.00 | SD × 0.10 | 4.5× |
| 1000 | 31.62 | SD × 0.03 | 14.1× |

---

**啟示**：

- 從 N=5 到 N=30：精確度提升 **2.4 倍**（投資報酬率最高）
- 從 N=100 到 N=1000：精確度只再提升 **3 倍**（報酬遞減）

> 科學研究中，「增加樣本數」是提高研究品質最直接的方法


# Part 5：區間估計的雛形

---

## 從點估計到區間估計

**點估計**：$\bar{X} = 17.2$ → 這是我們對 $\mu$ 的最佳猜測

**問題**：我們有多大的信心？

**區間估計**：$17.2 \pm 2 \times SE$ → 我們有 95% 的信心，$\mu$ 在這個範圍內

**下週預告**：

- 為什麼是「95%」？
- 什麼是「信賴區間（CI）」？
- 為什麼小樣本需要「t 分佈」而不是「常態分佈」？


# Part 6：作業說明

---

## 本週作業：CLT 視覺化挑戰

**資料**：個人化 `W08_CLT_Simulation_[學號].csv`

你的資料包含 6 個變項（各 1,000 筆）：

| 變項 | 說明 |
|:-----|:-----|
| `Pop_RT` | RT_ms 母群代表樣本（右偏） |
| `Means_RT_N5` | RT_ms 抽樣分佈（每次 N=5，1000次） |
| `Means_RT_N100` | RT_ms 抽樣分佈（每次 N=100，1000次） |
| `Pop_Total` | Total_Score 母群代表樣本（近似常態） |
| `Means_TS_N5` | Total_Score 抽樣分佈（每次 N=5） |
| `Means_TS_N100` | Total_Score 抽樣分佈（每次 N=100） |

---

## 任務 1：形狀對比（The Shape）

**操作**：

1. 匯入 CSV，設定所有變項為 **Continuous**
2. 使用 **Exploration → Descriptives** 繪製 6 個變項的直方圖
3. 勾選 **Statistics**：Mean, SD, Skewness

**診斷**：在報告中描述：


- `Pop_XX` vs. `Means_YY` 的分佈形狀差異
- `Means_YY`的分佈是否符合CLT ？你的判斷是什麼？

---

## 任務 2：精確度競賽（The Precision）

**計算**：

- 記錄 `Means_RT_N5` 和 `Means_RT_N100` 的 SD（這就是 SE）
- 記錄 `Means_TS_N5` 和 `Means_TS_N100` 的 SD

**驗證**：

$$\frac{SE_{N=100}}{SE_{N=5}} \approx \frac{\sqrt{5}}{\sqrt{100}} \approx 0.224$$

你的實際比值是多少？與理論值吻合嗎？

---

## 任務 3：觀念辨析

在報告中回答以下問題：

1. **區分概念**：「樣本分佈」和「抽樣分佈」有什麼不同？請用你的資料舉例說明。

2. **SE 的意義**：為什麼增加樣本數 $N$ 可以縮小標準誤？這對科學研究有什麼啟示？

3. **CLT 的威力**：為什麼即使 Pop_RT 是右偏的，Means_RT_N100 卻接近常態分佈？

---

## 繳交要求

**檔案 1：學號_姓名_W8_Lab.omv**

- 6 個變項的 Descriptives 分析（直方圖 + 統計量）
- 確認已勾選：Mean, SD, Skewness

**檔案 2：學號_姓名_W8_Report.docx**

- 分析結果：貼上直方圖與描述統計表，以APA格式說明圖表重點
- 計算驗證：SE 比值計算過程
- 反思問題：回答 3 題觀念問題

**繳交期限**：本週上課結束前


# 小結與展望

---

## 本週核心概念

1. **母群 vs. 樣本**：統計推論 = 用樣本推測母群
2. **大數法則**：N 越大，$\bar{X}$ 越接近 $\mu$
3. **中央極限定理**：無論母群形狀，$\bar{X}$ 的分佈趨近常態
4. **標準誤**：$SE = SD / \sqrt{N}$，衡量估計的精確度
5. **N 是最強槓桿**：增加樣本數 = 提高精確度

---

## 下週預告：信賴區間與 t 分佈

**下週問題**：

- 我們知道 SE 了，但 95% 信賴區間怎麼算？
- 為什麼小樣本不能用常態分佈，要用 **t 分佈**？
- **自由度（df）**是什麼？為什麼 $N - 1$？

**資料**：個人化 W9 抽樣資料（N=5/30/100 三組樣本）

---

## 課後資源

**電子書**：

- [第 8 章：運用樣本估計未知量數](https://scgeeker.github.io/lsj-book-zh_tw/08-Estimating-unknown-quantities-from-a-sample.html)

**關鍵術語對照**：

| 中文 | 英文 | 符號 |
|:-----|:-----|:-----|
| 母群 | Population | — |
| 樣本 | Sample | — |
| 母群平均數 | Population Mean | $\mu$ |
| 樣本平均數 | Sample Mean | $\bar{X}$ |
| 標準差 | Standard Deviation | $SD$ 或 $\sigma$ |
| 標準誤 | Standard Error | $SE$ 或 $SEM$ |
| 抽樣分佈 | Sampling Distribution | — |
| 中央極限定理 | Central Limit Theorem | CLT |

---

## Q & A
